{% extends "base.html" %}

{% block title %}Dashboard ‚Ä¢ Social Link Hub{% endblock %}

{% block content %}
<main class="app-main">
  <!-- Left: editor -->
  <section class="panel panel-editor">
    <div class="panel-header">
      <h2>Profile setup</h2>
      <p>Fill your details and watch the preview glow on the right ‚ú®</p>
    </div>

    <form
      id="profileForm"
      method="POST"
      action="{{ url_for('index') }}"
      enctype="multipart/form-data"
      class="profile-form"
    >
      <!-- Basic info -->
      <div class="section">
        <h3 class="section-title">Basic details</h3>

        <div class="field-group">
          <label for="name">Display name</label>
          <input
            type="text"
            id="name"
            name="name"
            placeholder="Asta / @yourhandle"
            value="{{ profile.get('name', '') }}"
          />
        </div>

        <div class="field-group">
          <label for="bio">Bio</label>
          <textarea
            id="bio"
            name="bio"
            placeholder="Tell them who you are, in one cute line..."
          >{{ profile.get('bio', '') }}</textarea>
          <p class="hint">
            Example: ‚ÄúCS undergrad | Coffee-fuelled coder ‚òï‚ú®‚Äù
          </p>
        </div>
      </div>

      <!-- Avatar -->
      <div class="section">
        <h3 class="section-title">Profile picture</h3>

        <div class="avatar-row">
          <div class="field-group">
            <label for="avatar">Upload image</label>
            <input
              type="file"
              id="avatar"
              name="avatar"
              accept="image/*"
            />
            <p class="hint">
              Choose a clear square photo for best results.
            </p>
          </div>

          <div class="current-avatar">
            <span class="mini-label">Current preview</span>
            <div class="current-avatar-frame">
              {% if profile.get('avatar') %}
                <img
                  src="{{ url_for('static', filename=profile.get('avatar')) }}"
                  alt="Profile picture"
                />
              {% else %}
                <span class="placeholder-icon">‚ú®</span>
              {% endif %}
            </div>
            {% if profile.get('avatar') %}
              <p class="hint" style="margin-top:0.3rem; word-break:break-all;">
                Stored as: <code>{{ profile.get('avatar') }}</code>
              </p>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Social links -->
      <div class="section">
        <h3 class="section-title">Social links</h3>
        <p class="section-subtitle">
          Paste the full URL for each platform you want to show.
        </p>

        <div class="field-row">
          <div class="field-group">
            <label for="instagram">Instagram</label>
            <input
              type="url"
              id="instagram"
              name="instagram"
              placeholder="https://instagram.com/username"
              value="{{ profile.get('instagram', '') }}"
            />
          </div>
          <div class="field-group">
            <label for="twitter">X (Twitter)</label>
            <input
              type="url"
              id="twitter"
              name="twitter"
              placeholder="https://x.com/username"
              value="{{ profile.get('twitter', '') }}"
            />
          </div>
        </div>

        <div class="field-row">
          <div class="field-group">
            <label for="youtube">YouTube</label>
            <input
              type="url"
              id="youtube"
              name="youtube"
              placeholder="https://youtube.com/@channel"
              value="{{ profile.get('youtube', '') }}"
            />
          </div>
          <div class="field-group">
            <label for="linkedin">LinkedIn</label>
            <input
              type="url"
              id="linkedin"
              name="linkedin"
              placeholder="https://linkedin.com/in/you"
              value="{{ profile.get('linkedin', '') }}"
            />
          </div>
        </div>

        <div class="field-row">
          <div class="field-group">
            <label for="github">GitHub</label>
            <input
              type="url"
              id="github"
              name="github"
              placeholder="https://github.com/username"
              value="{{ profile.get('github', '') }}"
            />
          </div>
          <div class="field-group">
            <label for="customLabel">Custom label</label>
            <input
              type="text"
              id="customLabel"
              name="customLabel"
              placeholder="Portfolio / Blog / Notion etc."
              value="{{ profile.get('customLabel', '') }}"
            />
          </div>
        </div>

        <div class="field-row">
          <div class="field-group">
            <label for="customUrl">Custom URL</label>
            <input
              type="url"
              id="customUrl"
              name="customUrl"
              placeholder="https://your-site.xyz"
              value="{{ profile.get('customUrl', '') }}"
            />
          </div>
        </div>
      </div>

      <div class="form-footer">
        <p class="save-hint">
          Click save to store this profile on the server.
        </p>
        <button type="submit" class="btn btn-primary">
          <span>Save profile</span> <span>üíæ</span>
        </button>
      </div>
    </form>
  </section>

  <!-- Right: live preview -->
  <section class="panel panel-preview">
    <div class="panel-header">
      <h2>Live preview</h2>
      <p>How your link page feels to the world.</p>
    </div>

    <div class="preview-inner">
      <div class="profile-card">
        <div class="profile-glow"></div>

        <div class="avatar" id="previewAvatar">
          {% if profile.get('avatar') %}
            <img
              src="{{ url_for('static', filename=profile.get('avatar')) }}"
              alt="Profile picture"
            />
          {% else %}
            <span>‚ú®</span>
          {% endif %}
        </div>

        <div class="profile-name" id="previewName">
          {{ profile.get('name', '') or 'Your Name' }}
        </div>

        <div class="profile-tag">@{{ g.user["username"] }}</div>

        <p class="profile-bio" id="previewBio">
          {{ profile.get('bio', '') or 'Your bio will appear here. Make it short, cute, and very you.' }}
        </p>

        <div class="link-list">
          <a id="linkInstagram" class="link-btn instagram" target="_blank" style="display:none;">
            <span class="icon">üì∏</span>
            <span>Instagram</span>
          </a>

          <a id="linkTwitter" class="link-btn twitter" target="_blank" style="display:none;">
            <span class="icon">üê¶</span>
            <span>X (Twitter)</span>
          </a>

          <a id="linkYoutube" class="link-btn youtube" target="_blank" style="display:none;">
            <span class="icon">‚ñ∂Ô∏è</span>
            <span>YouTube</span>
          </a>

          <a id="linkLinkedin" class="link-btn linkedin" target="_blank" style="display:none;">
            <span class="icon">üíº</span>
            <span>LinkedIn</span>
          </a>

          <a id="linkGithub" class="link-btn github" target="_blank" style="display:none;">
            <span class="icon">üíª</span>
            <span>GitHub</span>
          </a>

          <a id="linkCustom" class="link-btn" target="_blank" style="display:none;">
            <span class="icon">üîó</span>
            <span id="linkCustomLabel">Custom Link</span>
          </a>
        </div>

        <<div class="card-footer-note">
  Your public link:
  <code id="publicLink">/u/{{ g.user["username"] }}</code>

  <button
    type="button"
    id="copyLinkBtn"
    class="btn btn-ghost small-btn"
    style="margin-left: 0.5rem;"
  >
    üîó Copy Link
  </button>
</div>

<p
  id="copyMsg"
  style="font-size: 0.75rem; color: #9ca3af; display: none; margin-top: 0.5rem;"
>
  ‚úÖ Link copied to clipboard!
</p>

      </div>
    </div>
  </section>
</main>
{% endblock %}
